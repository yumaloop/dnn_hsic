
Model intermediate layer output
==========================

in_data : (10000, 784)
----------------------------------------------
layer1_output : (10000, 512)
----------------------------------------------
activation1_output : (10000, 512)
----------------------------------------------
layer2_output : (10000, 256)
----------------------------------------------
activation2_output : (10000, 256)
----------------------------------------------
layer3_output : (10000, 128)
----------------------------------------------
activation3_output : (10000, 128)
----------------------------------------------
layer4_output : (10000, 64)
----------------------------------------------
activation4_output : (10000, 64)
----------------------------------------------
layer5_output : (10000, 10)
----------------------------------------------
activation5_output : (10000, 10)
lay1.shape : (10000, 512)
in_data.shape : (10000, 784)
Gram(X) : [[1.         0.15637594 0.42747743 ... 0.40518786 0.33860562 0.10072221]
 [0.15637594 1.         0.24085124 ... 0.10269603 0.19051709 0.17812611]
 [0.42747743 0.24085124 1.         ... 0.28255777 0.32942427 0.0989611 ]
 ...
 [0.40518786 0.10269603 0.28255777 ... 1.         0.35806507 0.16726996]
 [0.33860562 0.19051709 0.32942427 ... 0.35806507 1.         0.13723151]
 [0.10072221 0.17812611 0.0989611  ... 0.16726996 0.13723151 1.        ]] 
Gram(X) mean : 0.3024350058364991
Gram(Y) : [[1.         0.98286428 0.99013259 ... 0.98921276 0.98747714 0.97912382]
 [0.98286428 1.         0.98694616 ... 0.97926098 0.9857912  0.98084039]
 [0.99013259 0.98694616 1.         ... 0.98850985 0.98925622 0.98180529]
 ...
 [0.98921276 0.97926098 0.98850985 ... 1.         0.98839141 0.98245962]
 [0.98747714 0.9857912  0.98925622 ... 0.98839141 1.         0.98153454]
 [0.97912382 0.98084039 0.98180529 ... 0.98245962 0.98153454 1.        ]] 
Gram(Y) mean : 0.9857239019223212

-------------------------------------------------
HSIC(lay1, in_data) = 0.0002634407440181738
m : 10000
sigma : 75
-------------------------------------------------

lay1.shape : (10000, 512)
lay1.shape : (10000, 512)
Gram(X) : [[1.         0.15637594 0.42747743 ... 0.40518786 0.33860562 0.10072221]
 [0.15637594 1.         0.24085124 ... 0.10269603 0.19051709 0.17812611]
 [0.42747743 0.24085124 1.         ... 0.28255777 0.32942427 0.0989611 ]
 ...
 [0.40518786 0.10269603 0.28255777 ... 1.         0.35806507 0.16726996]
 [0.33860562 0.19051709 0.32942427 ... 0.35806507 1.         0.13723151]
 [0.10072221 0.17812611 0.0989611  ... 0.16726996 0.13723151 1.        ]] 
Gram(X) mean : 0.3024350058364991
Gram(Y) : [[1.         0.15637594 0.42747743 ... 0.40518786 0.33860562 0.10072221]
 [0.15637594 1.         0.24085124 ... 0.10269603 0.19051709 0.17812611]
 [0.42747743 0.24085124 1.         ... 0.28255777 0.32942427 0.0989611 ]
 ...
 [0.40518786 0.10269603 0.28255777 ... 1.         0.35806507 0.16726996]
 [0.33860562 0.19051709 0.32942427 ... 0.35806507 1.         0.13723151]
 [0.10072221 0.17812611 0.0989611  ... 0.16726996 0.13723151 1.        ]] 
Gram(Y) mean : 0.3024350058364991

-------------------------------------------------
HSIC(lay1, lay1) = 0.012456966573758922
m : 10000
sigma : 75
-------------------------------------------------

lay1.shape : (10000, 512)
act1.shape : (10000, 512)
Gram(X) : [[1.         0.15637594 0.42747743 ... 0.40518786 0.33860562 0.10072221]
 [0.15637594 1.         0.24085124 ... 0.10269603 0.19051709 0.17812611]
 [0.42747743 0.24085124 1.         ... 0.28255777 0.32942427 0.0989611 ]
 ...
 [0.40518786 0.10269603 0.28255777 ... 1.         0.35806507 0.16726996]
 [0.33860562 0.19051709 0.32942427 ... 0.35806507 1.         0.13723151]
 [0.10072221 0.17812611 0.0989611  ... 0.16726996 0.13723151 1.        ]] 
Gram(X) mean : 0.3024350058364991
Gram(Y) : [[1.         0.87238576 0.93200192 ... 0.92108394 0.91604036 0.86230324]
 [0.87238576 1.         0.89867872 ... 0.85870517 0.86883335 0.84738073]
 [0.93200192 0.89867872 1.         ... 0.94189769 0.93164516 0.8867717 ]
 ...
 [0.92108394 0.85870517 0.94189769 ... 1.         0.91153412 0.86548474]
 [0.91604036 0.86883335 0.93164516 ... 0.91153412 1.         0.87108778]
 [0.86230324 0.84738073 0.8867717  ... 0.86548474 0.87108778 1.        ]] 
Gram(Y) mean : 0.9097186289937974

-------------------------------------------------
HSIC(lay1, act1) = 0.0013570195747020857
m : 10000
sigma : 75
-------------------------------------------------

lay1.shape : (10000, 512)
lay2.shape : (10000, 256)
Gram(X) : [[1.         0.15637594 0.42747743 ... 0.40518786 0.33860562 0.10072221]
 [0.15637594 1.         0.24085124 ... 0.10269603 0.19051709 0.17812611]
 [0.42747743 0.24085124 1.         ... 0.28255777 0.32942427 0.0989611 ]
 ...
 [0.40518786 0.10269603 0.28255777 ... 1.         0.35806507 0.16726996]
 [0.33860562 0.19051709 0.32942427 ... 0.35806507 1.         0.13723151]
 [0.10072221 0.17812611 0.0989611  ... 0.16726996 0.13723151 1.        ]] 
Gram(X) mean : 0.3024350058364991
Gram(Y) : [[1.         0.06310509 0.23827999 ... 0.14497741 0.14663196 0.04364724]
 [0.06310509 1.         0.08600751 ... 0.0185951  0.03991024 0.06961657]
 [0.23827999 0.08600751 1.         ... 0.34568196 0.18410435 0.09772456]
 ...
 [0.14497741 0.0185951  0.34568196 ... 1.         0.11840573 0.06115947]
 [0.14663196 0.03991024 0.18410435 ... 0.11840573 1.         0.08745846]
 [0.04364724 0.06961657 0.09772456 ... 0.06115947 0.08745846 1.        ]] 
Gram(Y) mean : 0.22902580372456152

-------------------------------------------------
HSIC(lay1, lay2) = 0.010416777485002112
m : 10000
sigma : 75
-------------------------------------------------

lay1.shape : (10000, 512)
act2.shape : (10000, 256)
Gram(X) : [[1.         0.15637594 0.42747743 ... 0.40518786 0.33860562 0.10072221]
 [0.15637594 1.         0.24085124 ... 0.10269603 0.19051709 0.17812611]
 [0.42747743 0.24085124 1.         ... 0.28255777 0.32942427 0.0989611 ]
 ...
 [0.40518786 0.10269603 0.28255777 ... 1.         0.35806507 0.16726996]
 [0.33860562 0.19051709 0.32942427 ... 0.35806507 1.         0.13723151]
 [0.10072221 0.17812611 0.0989611  ... 0.16726996 0.13723151 1.        ]] 
Gram(X) mean : 0.3024350058364991
Gram(Y) : [[1.         0.60804652 0.79166706 ... 0.70148784 0.63374902 0.58373583]
 [0.60804652 1.         0.64265333 ... 0.51606202 0.53538304 0.55492203]
 [0.79166706 0.64265333 1.         ... 0.72768354 0.6517428  0.6295012 ]
 ...
 [0.70148784 0.51606202 0.72768354 ... 1.         0.56438145 0.54656139]
 [0.63374902 0.53538304 0.6517428  ... 0.56438145 1.         0.57092576]
 [0.58373583 0.55492203 0.6295012  ... 0.54656139 0.57092576 1.        ]] 
Gram(Y) mean : 0.7232757141382118

-------------------------------------------------
HSIC(lay1, act2) = 0.00452367507896154
m : 10000
sigma : 75
-------------------------------------------------

lay1.shape : (10000, 512)
lay3.shape : (10000, 128)
Gram(X) : [[1.         0.15637594 0.42747743 ... 0.40518786 0.33860562 0.10072221]
 [0.15637594 1.         0.24085124 ... 0.10269603 0.19051709 0.17812611]
 [0.42747743 0.24085124 1.         ... 0.28255777 0.32942427 0.0989611 ]
 ...
 [0.40518786 0.10269603 0.28255777 ... 1.         0.35806507 0.16726996]
 [0.33860562 0.19051709 0.32942427 ... 0.35806507 1.         0.13723151]
 [0.10072221 0.17812611 0.0989611  ... 0.16726996 0.13723151 1.        ]] 
Gram(X) mean : 0.3024350058364991
Gram(Y) : [[1.         0.01484346 0.12204703 ... 0.02904624 0.01963179 0.0045642 ]
 [0.01484346 1.         0.01356826 ... 0.00496413 0.00172748 0.00721862]
 [0.12204703 0.01356826 1.         ... 0.03652746 0.00864021 0.01583323]
 ...
 [0.02904624 0.00496413 0.03652746 ... 1.         0.00259289 0.00400807]
 [0.01963179 0.00172748 0.00864021 ... 0.00259289 1.         0.01042717]
 [0.0045642  0.00721862 0.01583323 ... 0.00400807 0.01042717 1.        ]] 
Gram(Y) mean : 0.14121098568455734

-------------------------------------------------
HSIC(lay1, lay3) = 0.009755719057410111
m : 10000
sigma : 75
-------------------------------------------------

lay1.shape : (10000, 512)
act3.shape : (10000, 128)
Gram(X) : [[1.         0.15637594 0.42747743 ... 0.40518786 0.33860562 0.10072221]
 [0.15637594 1.         0.24085124 ... 0.10269603 0.19051709 0.17812611]
 [0.42747743 0.24085124 1.         ... 0.28255777 0.32942427 0.0989611 ]
 ...
 [0.40518786 0.10269603 0.28255777 ... 1.         0.35806507 0.16726996]
 [0.33860562 0.19051709 0.32942427 ... 0.35806507 1.         0.13723151]
 [0.10072221 0.17812611 0.0989611  ... 0.16726996 0.13723151 1.        ]] 
Gram(X) mean : 0.3024350058364991
Gram(Y) : [[1.         0.51649362 0.67947823 ... 0.42459765 0.40930427 0.28632853]
 [0.51649362 1.         0.51527711 ... 0.33471824 0.39171121 0.2779958 ]
 [0.67947823 0.51527711 1.         ... 0.41238293 0.45997158 0.36548075]
 ...
 [0.42459765 0.33471824 0.41238293 ... 1.         0.26939072 0.24728562]
 [0.40930427 0.39171121 0.45997158 ... 0.26939072 1.         0.43821383]
 [0.28632853 0.2779958  0.36548075 ... 0.24728562 0.43821383 1.        ]] 
Gram(Y) mean : 0.5660896041359038

-------------------------------------------------
HSIC(lay1, act3) = 0.007451573117381075
m : 10000
sigma : 75
-------------------------------------------------

lay1.shape : (10000, 512)
lay4.shape : (10000, 64)
Gram(X) : [[1.         0.15637594 0.42747743 ... 0.40518786 0.33860562 0.10072221]
 [0.15637594 1.         0.24085124 ... 0.10269603 0.19051709 0.17812611]
 [0.42747743 0.24085124 1.         ... 0.28255777 0.32942427 0.0989611 ]
 ...
 [0.40518786 0.10269603 0.28255777 ... 1.         0.35806507 0.16726996]
 [0.33860562 0.19051709 0.32942427 ... 0.35806507 1.         0.13723151]
 [0.10072221 0.17812611 0.0989611  ... 0.16726996 0.13723151 1.        ]] 
Gram(X) mean : 0.3024350058364991
Gram(Y) : [[1.         0.23019463 0.40220577 ... 0.24073226 0.27761543 0.09519281]
 [0.23019463 1.         0.21558685 ... 0.12384074 0.10056381 0.06496537]
 [0.40220577 0.21558685 1.         ... 0.16597838 0.23581753 0.14088205]
 ...
 [0.24073226 0.12384074 0.16597838 ... 1.         0.08411014 0.12909941]
 [0.27761543 0.10056381 0.23581753 ... 0.08411014 1.         0.1335879 ]
 [0.09519281 0.06496537 0.14088205 ... 0.12909941 0.1335879  1.        ]] 
Gram(Y) mean : 0.36326248708578707

-------------------------------------------------
HSIC(lay1, lay4) = 0.00940600973957347
m : 10000
sigma : 75
-------------------------------------------------

lay1.shape : (10000, 512)
act4.shape : (10000, 64)
Gram(X) : [[1.         0.15637594 0.42747743 ... 0.40518786 0.33860562 0.10072221]
 [0.15637594 1.         0.24085124 ... 0.10269603 0.19051709 0.17812611]
 [0.42747743 0.24085124 1.         ... 0.28255777 0.32942427 0.0989611 ]
 ...
 [0.40518786 0.10269603 0.28255777 ... 1.         0.35806507 0.16726996]
 [0.33860562 0.19051709 0.32942427 ... 0.35806507 1.         0.13723151]
 [0.10072221 0.17812611 0.0989611  ... 0.16726996 0.13723151 1.        ]] 
Gram(X) mean : 0.3024350058364991
Gram(Y) : [[1.         0.73796383 0.86023259 ... 0.86299496 0.81036185 0.78034352]
 [0.73796383 1.         0.75519584 ... 0.75613153 0.7270029  0.71561122]
 [0.86023259 0.75519584 1.         ... 0.83235823 0.80355343 0.7636102 ]
 ...
 [0.86299496 0.75613153 0.83235823 ... 1.         0.77653886 0.7456704 ]
 [0.81036185 0.7270029  0.80355343 ... 0.77653886 1.         0.74807556]
 [0.78034352 0.71561122 0.7636102  ... 0.7456704  0.74807556 1.        ]] 
Gram(Y) mean : 0.8521702226233577

-------------------------------------------------
HSIC(lay1, act4) = 0.002617222477863397
m : 10000
sigma : 75
-------------------------------------------------

lay1.shape : (10000, 512)
lay5.shape : (10000, 10)
Gram(X) : [[1.         0.15637594 0.42747743 ... 0.40518786 0.33860562 0.10072221]
 [0.15637594 1.         0.24085124 ... 0.10269603 0.19051709 0.17812611]
 [0.42747743 0.24085124 1.         ... 0.28255777 0.32942427 0.0989611 ]
 ...
 [0.40518786 0.10269603 0.28255777 ... 1.         0.35806507 0.16726996]
 [0.33860562 0.19051709 0.32942427 ... 0.35806507 1.         0.13723151]
 [0.10072221 0.17812611 0.0989611  ... 0.16726996 0.13723151 1.        ]] 
Gram(X) mean : 0.3024350058364991
Gram(Y) : [[1.         0.87655945 0.92825546 ... 0.92399854 0.864934   0.82514286]
 [0.87655945 1.         0.96296024 ... 0.87551886 0.94194348 0.93990641]
 [0.92825546 0.96296024 1.         ... 0.93664879 0.94687725 0.95504826]
 ...
 [0.92399854 0.87551886 0.93664879 ... 1.         0.91485951 0.9177994 ]
 [0.864934   0.94194348 0.94687725 ... 0.91485951 1.         0.95720723]
 [0.82514286 0.93990641 0.95504826 ... 0.9177994  0.95720723 1.        ]] 
Gram(Y) mean : 0.9414947313129798

-------------------------------------------------
HSIC(lay1, lay5) = 0.000992908587599622
m : 10000
sigma : 75
-------------------------------------------------

lay1.shape : (10000, 512)
act5.shape : (10000, 10)
Gram(X) : [[1.         0.15637594 0.42747743 ... 0.40518786 0.33860562 0.10072221]
 [0.15637594 1.         0.24085124 ... 0.10269603 0.19051709 0.17812611]
 [0.42747743 0.24085124 1.         ... 0.28255777 0.32942427 0.0989611 ]
 ...
 [0.40518786 0.10269603 0.28255777 ... 1.         0.35806507 0.16726996]
 [0.33860562 0.19051709 0.32942427 ... 0.35806507 1.         0.13723151]
 [0.10072221 0.17812611 0.0989611  ... 0.16726996 0.13723151 1.        ]] 
Gram(X) mean : 0.3024350058364991
Gram(Y) : [[1.         0.99999653 0.99999653 ... 0.99999653 0.99999653 0.99999653]
 [0.99999653 1.         0.99999653 ... 0.99999653 0.99999653 0.99999653]
 [0.99999653 0.99999653 1.         ... 0.99999653 0.99999653 0.99999653]
 ...
 [0.99999653 0.99999653 0.99999653 ... 1.         0.99999653 0.99999653]
 [0.99999653 0.99999653 0.99999653 ... 0.99999653 1.         0.99999653]
 [0.99999653 0.99999653 0.99999653 ... 0.99999653 0.99999653 1.        ]] 
Gram(Y) mean : 0.9999969009235882

-------------------------------------------------
HSIC(lay1, act5) = 5.291088777521068e-08
m : 10000
sigma : 75
-------------------------------------------------

