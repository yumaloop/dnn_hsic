
Model intermediate layer output
==========================

in_data : (10000, 784)
----------------------------------------------
layer1_output : (10000, 512)
----------------------------------------------
activation1_output : (10000, 512)
----------------------------------------------
layer2_output : (10000, 256)
----------------------------------------------
activation2_output : (10000, 256)
----------------------------------------------
layer3_output : (10000, 128)
----------------------------------------------
activation3_output : (10000, 128)
----------------------------------------------
layer4_output : (10000, 64)
----------------------------------------------
activation4_output : (10000, 64)
----------------------------------------------
layer5_output : (10000, 10)
----------------------------------------------
activation5_output : (10000, 10)
lay2.shape : (10000, 256)
in_data.shape : (10000, 784)
Gram(X) : [[1.00000000e+00 3.98225230e-03 5.67773549e-02 ... 2.10184492e-02
  2.15009318e-02 1.90508141e-03]
 [3.98225230e-03 1.00000000e+00 7.39729122e-03 ... 3.45777660e-04
  1.59282739e-03 4.84646659e-03]
 [5.67773549e-02 7.39729122e-03 1.00000000e+00 ... 1.19496017e-01
  3.38944104e-02 9.55008999e-03]
 ...
 [2.10184492e-02 3.45777660e-04 1.19496017e-01 ... 1.00000000e+00
  1.40199168e-02 3.74048133e-03]
 [2.15009318e-02 1.59282739e-03 3.38944104e-02 ... 1.40199168e-02
  1.00000000e+00 7.64898286e-03]
 [1.90508141e-03 4.84646659e-03 9.55008999e-03 ... 3.74048133e-03
  7.64898286e-03 1.00000000e+00]] 
Gram(X) mean : 0.08434050065710545
Gram(Y) : [[1.         0.96602219 0.98036254 ... 0.97854188 0.97511111 0.95868346]
 [0.96602219 1.         0.97406272 ... 0.95895206 0.97178429 0.96204786]
 [0.98036254 0.97406272 1.         ... 0.97715172 0.97862786 0.96394163]
 ...
 [0.97854188 0.95895206 0.97715172 ... 1.         0.97691758 0.96522691]
 [0.97511111 0.97178429 0.97862786 ... 0.97691758 1.         0.96341005]
 [0.95868346 0.96204786 0.96394163 ... 0.96522691 0.96341005 1.        ]] 
Gram(Y) mean : 0.9716661551877026

-------------------------------------------------
HSIC(lay2, in_data) = 0.0003172494379302981
m : 10000
sigma : 75
-------------------------------------------------

lay2.shape : (10000, 256)
lay1.shape : (10000, 512)
Gram(X) : [[1.00000000e+00 3.98225230e-03 5.67773549e-02 ... 2.10184492e-02
  2.15009318e-02 1.90508141e-03]
 [3.98225230e-03 1.00000000e+00 7.39729122e-03 ... 3.45777660e-04
  1.59282739e-03 4.84646659e-03]
 [5.67773549e-02 7.39729122e-03 1.00000000e+00 ... 1.19496017e-01
  3.38944104e-02 9.55008999e-03]
 ...
 [2.10184492e-02 3.45777660e-04 1.19496017e-01 ... 1.00000000e+00
  1.40199168e-02 3.74048133e-03]
 [2.15009318e-02 1.59282739e-03 3.38944104e-02 ... 1.40199168e-02
  1.00000000e+00 7.64898286e-03]
 [1.90508141e-03 4.84646659e-03 9.55008999e-03 ... 3.74048133e-03
  7.64898286e-03 1.00000000e+00]] 
Gram(X) mean : 0.08434050065710545
Gram(Y) : [[1.         0.02445343 0.18273695 ... 0.16417721 0.11465377 0.01014496]
 [0.02445343 1.         0.05800932 ... 0.01054648 0.03629676 0.03172891]
 [0.18273695 0.05800932 1.         ... 0.07983889 0.10852035 0.0097933 ]
 ...
 [0.16417721 0.01054648 0.07983889 ... 1.         0.12821059 0.02797924]
 [0.11465377 0.03629676 0.10852035 ... 0.12821059 1.         0.01883249]
 [0.01014496 0.03172891 0.0097933  ... 0.02797924 0.01883249 1.        ]] 
Gram(Y) mean : 0.11449212734270327

-------------------------------------------------
HSIC(lay2, lay1) = 0.007441542134283385
m : 10000
sigma : 75
-------------------------------------------------

lay2.shape : (10000, 256)
act1.shape : (10000, 512)
Gram(X) : [[1.00000000e+00 3.98225230e-03 5.67773549e-02 ... 2.10184492e-02
  2.15009318e-02 1.90508141e-03]
 [3.98225230e-03 1.00000000e+00 7.39729122e-03 ... 3.45777660e-04
  1.59282739e-03 4.84646659e-03]
 [5.67773549e-02 7.39729122e-03 1.00000000e+00 ... 1.19496017e-01
  3.38944104e-02 9.55008999e-03]
 ...
 [2.10184492e-02 3.45777660e-04 1.19496017e-01 ... 1.00000000e+00
  1.40199168e-02 3.74048133e-03]
 [2.15009318e-02 1.59282739e-03 3.38944104e-02 ... 1.40199168e-02
  1.00000000e+00 7.64898286e-03]
 [1.90508141e-03 4.84646659e-03 9.55008999e-03 ... 3.74048133e-03
  7.64898286e-03 1.00000000e+00]] 
Gram(X) mean : 0.08434050065710545
Gram(Y) : [[1.         0.76105692 0.86862758 ... 0.84839563 0.83912994 0.74356687]
 [0.76105692 1.         0.80762344 ... 0.73737458 0.7548714  0.71805411]
 [0.86862758 0.80762344 1.         ... 0.88717126 0.86796271 0.78636405]
 ...
 [0.84839563 0.73737458 0.88717126 ... 1.         0.83089445 0.74906383]
 [0.83912994 0.7548714  0.86796271 ... 0.83089445 1.         0.75879392]
 [0.74356687 0.71805411 0.78636405 ... 0.74906383 0.75879392 1.        ]] 
Gram(Y) mean : 0.8287650805240903

-------------------------------------------------
HSIC(lay2, act1) = 0.0023048757782678374
m : 10000
sigma : 75
-------------------------------------------------

lay2.shape : (10000, 256)
lay2.shape : (10000, 256)
Gram(X) : [[1.00000000e+00 3.98225230e-03 5.67773549e-02 ... 2.10184492e-02
  2.15009318e-02 1.90508141e-03]
 [3.98225230e-03 1.00000000e+00 7.39729122e-03 ... 3.45777660e-04
  1.59282739e-03 4.84646659e-03]
 [5.67773549e-02 7.39729122e-03 1.00000000e+00 ... 1.19496017e-01
  3.38944104e-02 9.55008999e-03]
 ...
 [2.10184492e-02 3.45777660e-04 1.19496017e-01 ... 1.00000000e+00
  1.40199168e-02 3.74048133e-03]
 [2.15009318e-02 1.59282739e-03 3.38944104e-02 ... 1.40199168e-02
  1.00000000e+00 7.64898286e-03]
 [1.90508141e-03 4.84646659e-03 9.55008999e-03 ... 3.74048133e-03
  7.64898286e-03 1.00000000e+00]] 
Gram(X) mean : 0.08434050065710545
Gram(Y) : [[1.00000000e+00 3.98225230e-03 5.67773549e-02 ... 2.10184492e-02
  2.15009318e-02 1.90508141e-03]
 [3.98225230e-03 1.00000000e+00 7.39729122e-03 ... 3.45777660e-04
  1.59282739e-03 4.84646659e-03]
 [5.67773549e-02 7.39729122e-03 1.00000000e+00 ... 1.19496017e-01
  3.38944104e-02 9.55008999e-03]
 ...
 [2.10184492e-02 3.45777660e-04 1.19496017e-01 ... 1.00000000e+00
  1.40199168e-02 3.74048133e-03]
 [2.15009318e-02 1.59282739e-03 3.38944104e-02 ... 1.40199168e-02
  1.00000000e+00 7.64898286e-03]
 [1.90508141e-03 4.84646659e-03 9.55008999e-03 ... 3.74048133e-03
  7.64898286e-03 1.00000000e+00]] 
Gram(Y) mean : 0.08434050065710545

-------------------------------------------------
HSIC(lay2, lay2) = 0.012701395488732968
m : 10000
sigma : 75
-------------------------------------------------

lay2.shape : (10000, 256)
act2.shape : (10000, 256)
Gram(X) : [[1.00000000e+00 3.98225230e-03 5.67773549e-02 ... 2.10184492e-02
  2.15009318e-02 1.90508141e-03]
 [3.98225230e-03 1.00000000e+00 7.39729122e-03 ... 3.45777660e-04
  1.59282739e-03 4.84646659e-03]
 [5.67773549e-02 7.39729122e-03 1.00000000e+00 ... 1.19496017e-01
  3.38944104e-02 9.55008999e-03]
 ...
 [2.10184492e-02 3.45777660e-04 1.19496017e-01 ... 1.00000000e+00
  1.40199168e-02 3.74048133e-03]
 [2.15009318e-02 1.59282739e-03 3.38944104e-02 ... 1.40199168e-02
  1.00000000e+00 7.64898286e-03]
 [1.90508141e-03 4.84646659e-03 9.55008999e-03 ... 3.74048133e-03
  7.64898286e-03 1.00000000e+00]] 
Gram(X) mean : 0.08434050065710545
Gram(Y) : [[1.         0.36972057 0.62673673 ... 0.49208519 0.40163782 0.34074752]
 [0.36972057 1.         0.4130033  ... 0.26632001 0.286635   0.30793845]
 [0.62673673 0.4130033  1.         ... 0.52952334 0.42476868 0.39627176]
 ...
 [0.49208519 0.26632001 0.52952334 ... 1.         0.31852642 0.29872935]
 [0.40163782 0.286635   0.42476868 ... 0.31852642 1.         0.32595622]
 [0.34074752 0.30793845 0.39627176 ... 0.29872935 0.32595622 1.        ]] 
Gram(Y) mean : 0.5398264422767174

-------------------------------------------------
HSIC(lay2, act2) = 0.009741975129097195
m : 10000
sigma : 75
-------------------------------------------------

lay2.shape : (10000, 256)
lay3.shape : (10000, 128)
Gram(X) : [[1.00000000e+00 3.98225230e-03 5.67773549e-02 ... 2.10184492e-02
  2.15009318e-02 1.90508141e-03]
 [3.98225230e-03 1.00000000e+00 7.39729122e-03 ... 3.45777660e-04
  1.59282739e-03 4.84646659e-03]
 [5.67773549e-02 7.39729122e-03 1.00000000e+00 ... 1.19496017e-01
  3.38944104e-02 9.55008999e-03]
 ...
 [2.10184492e-02 3.45777660e-04 1.19496017e-01 ... 1.00000000e+00
  1.40199168e-02 3.74048133e-03]
 [2.15009318e-02 1.59282739e-03 3.38944104e-02 ... 1.40199168e-02
  1.00000000e+00 7.64898286e-03]
 [1.90508141e-03 4.84646659e-03 9.55008999e-03 ... 3.74048133e-03
  7.64898286e-03 1.00000000e+00]] 
Gram(X) mean : 0.08434050065710545
Gram(Y) : [[1.00000000e+00 2.20328258e-04 1.48954774e-02 ... 8.43684116e-04
  3.85407135e-04 2.08318813e-05]
 [2.20328258e-04 1.00000000e+00 1.84097640e-04 ... 2.46425520e-05
  2.98418142e-06 5.21085071e-05]
 [1.48954774e-02 1.84097640e-04 1.00000000e+00 ... 1.33425532e-03
  7.46531439e-05 2.50691123e-04]
 ...
 [8.43684116e-04 2.46425520e-05 1.33425532e-03 ... 1.00000000e+00
  6.72306353e-06 1.60646398e-05]
 [3.85407135e-04 2.98418142e-06 7.46531439e-05 ... 6.72306353e-06
  1.00000000e+00 1.08725907e-04]
 [2.08318813e-05 5.21085071e-05 2.50691123e-04 ... 1.60646398e-05
  1.08725907e-04 1.00000000e+00]] 
Gram(Y) mean : 0.05892092866199646

-------------------------------------------------
HSIC(lay2, lay3) = 0.013533820792806439
m : 10000
sigma : 75
-------------------------------------------------

lay2.shape : (10000, 256)
act3.shape : (10000, 128)
Gram(X) : [[1.00000000e+00 3.98225230e-03 5.67773549e-02 ... 2.10184492e-02
  2.15009318e-02 1.90508141e-03]
 [3.98225230e-03 1.00000000e+00 7.39729122e-03 ... 3.45777660e-04
  1.59282739e-03 4.84646659e-03]
 [5.67773549e-02 7.39729122e-03 1.00000000e+00 ... 1.19496017e-01
  3.38944104e-02 9.55008999e-03]
 ...
 [2.10184492e-02 3.45777660e-04 1.19496017e-01 ... 1.00000000e+00
  1.40199168e-02 3.74048133e-03]
 [2.15009318e-02 1.59282739e-03 3.38944104e-02 ... 1.40199168e-02
  1.00000000e+00 7.64898286e-03]
 [1.90508141e-03 4.84646659e-03 9.55008999e-03 ... 3.74048133e-03
  7.64898286e-03 1.00000000e+00]] 
Gram(X) mean : 0.08434050065710545
Gram(Y) : [[1.         0.26676566 0.46169067 ... 0.18028317 0.16752998 0.08198403]
 [0.26676566 1.         0.2655105  ... 0.1120363  0.15343768 0.07728167]
 [0.46169067 0.2655105  1.         ... 0.17005968 0.21157385 0.13357618]
 ...
 [0.18028317 0.1120363  0.17005968 ... 1.         0.07257136 0.06115018]
 [0.16752998 0.15343768 0.21157385 ... 0.07257136 1.         0.19203136]
 [0.08198403 0.07728167 0.13357618 ... 0.06115018 0.19203136 1.        ]] 
Gram(Y) mean : 0.3704853317219905

-------------------------------------------------
HSIC(lay2, act3) = 0.015578591440108716
m : 10000
sigma : 75
-------------------------------------------------

lay2.shape : (10000, 256)
lay4.shape : (10000, 64)
Gram(X) : [[1.00000000e+00 3.98225230e-03 5.67773549e-02 ... 2.10184492e-02
  2.15009318e-02 1.90508141e-03]
 [3.98225230e-03 1.00000000e+00 7.39729122e-03 ... 3.45777660e-04
  1.59282739e-03 4.84646659e-03]
 [5.67773549e-02 7.39729122e-03 1.00000000e+00 ... 1.19496017e-01
  3.38944104e-02 9.55008999e-03]
 ...
 [2.10184492e-02 3.45777660e-04 1.19496017e-01 ... 1.00000000e+00
  1.40199168e-02 3.74048133e-03]
 [2.15009318e-02 1.59282739e-03 3.38944104e-02 ... 1.40199168e-02
  1.00000000e+00 7.64898286e-03]
 [1.90508141e-03 4.84646659e-03 9.55008999e-03 ... 3.74048133e-03
  7.64898286e-03 1.00000000e+00]] 
Gram(X) mean : 0.08434050065710545
Gram(Y) : [[1.         0.05298957 0.16176948 ... 0.05795202 0.07707033 0.00906167]
 [0.05298957 1.         0.04647769 ... 0.01533653 0.01011308 0.0042205 ]
 [0.16176948 0.04647769 1.         ... 0.02754882 0.05560991 0.01984775]
 ...
 [0.05795202 0.01533653 0.02754882 ... 1.         0.00707452 0.01666666]
 [0.07707033 0.01011308 0.05560991 ... 0.00707452 1.         0.01784573]
 [0.00906167 0.0042205  0.01984775 ... 0.01666666 0.01784573 1.        ]] 
Gram(Y) mean : 0.19638943947298035

-------------------------------------------------
HSIC(lay2, lay4) = 0.017600863745571363
m : 10000
sigma : 75
-------------------------------------------------

lay2.shape : (10000, 256)
act4.shape : (10000, 64)
Gram(X) : [[1.00000000e+00 3.98225230e-03 5.67773549e-02 ... 2.10184492e-02
  2.15009318e-02 1.90508141e-03]
 [3.98225230e-03 1.00000000e+00 7.39729122e-03 ... 3.45777660e-04
  1.59282739e-03 4.84646659e-03]
 [5.67773549e-02 7.39729122e-03 1.00000000e+00 ... 1.19496017e-01
  3.38944104e-02 9.55008999e-03]
 ...
 [2.10184492e-02 3.45777660e-04 1.19496017e-01 ... 1.00000000e+00
  1.40199168e-02 3.74048133e-03]
 [2.15009318e-02 1.59282739e-03 3.38944104e-02 ... 1.40199168e-02
  1.00000000e+00 7.64898286e-03]
 [1.90508141e-03 4.84646659e-03 9.55008999e-03 ... 3.74048133e-03
  7.64898286e-03 1.00000000e+00]] 
Gram(X) mean : 0.08434050065710545
Gram(Y) : [[1.         0.54459061 0.74000011 ... 0.74476031 0.65668632 0.608936  ]
 [0.54459061 1.         0.57032076 ... 0.57173489 0.52853322 0.51209942]
 [0.74000011 0.57032076 1.         ... 0.69282023 0.64569812 0.58310054]
 ...
 [0.74476031 0.57173489 0.69282023 ... 1.         0.60301259 0.55602434]
 [0.65668632 0.52853322 0.64569812 ... 0.60301259 1.         0.55961705]
 [0.608936   0.51209942 0.58310054 ... 0.55602434 0.55961705 1.        ]] 
Gram(Y) mean : 0.7362967610160488

-------------------------------------------------
HSIC(lay2, act4) = 0.006387380768733549
m : 10000
sigma : 75
-------------------------------------------------

lay2.shape : (10000, 256)
lay5.shape : (10000, 10)
Gram(X) : [[1.00000000e+00 3.98225230e-03 5.67773549e-02 ... 2.10184492e-02
  2.15009318e-02 1.90508141e-03]
 [3.98225230e-03 1.00000000e+00 7.39729122e-03 ... 3.45777660e-04
  1.59282739e-03 4.84646659e-03]
 [5.67773549e-02 7.39729122e-03 1.00000000e+00 ... 1.19496017e-01
  3.38944104e-02 9.55008999e-03]
 ...
 [2.10184492e-02 3.45777660e-04 1.19496017e-01 ... 1.00000000e+00
  1.40199168e-02 3.74048133e-03]
 [2.15009318e-02 1.59282739e-03 3.38944104e-02 ... 1.40199168e-02
  1.00000000e+00 7.64898286e-03]
 [1.90508141e-03 4.84646659e-03 9.55008999e-03 ... 3.74048133e-03
  7.64898286e-03 1.00000000e+00]] 
Gram(X) mean : 0.08434050065710545
Gram(Y) : [[1.         0.76835648 0.8616582  ... 0.85377331 0.74811082 0.68086074]
 [0.76835648 1.         0.92729243 ... 0.76653328 0.88725752 0.88342405]
 [0.8616582  0.92729243 1.         ... 0.87731096 0.89657653 0.91211718]
 ...
 [0.85377331 0.76653328 0.87731096 ... 1.         0.83696793 0.84235574]
 [0.74811082 0.88725752 0.89657653 ... 0.83696793 1.         0.91624568]
 [0.68086074 0.88342405 0.91211718 ... 0.84235574 0.91624568 1.        ]] 
Gram(Y) mean : 0.8898695134199691

-------------------------------------------------
HSIC(lay2, lay5) = 0.0024872946496018893
m : 10000
sigma : 75
-------------------------------------------------

lay1.shape : (10000, 256)
act5.shape : (10000, 10)
Gram(X) : [[1.00000000e+00 3.98225230e-03 5.67773549e-02 ... 2.10184492e-02
  2.15009318e-02 1.90508141e-03]
 [3.98225230e-03 1.00000000e+00 7.39729122e-03 ... 3.45777660e-04
  1.59282739e-03 4.84646659e-03]
 [5.67773549e-02 7.39729122e-03 1.00000000e+00 ... 1.19496017e-01
  3.38944104e-02 9.55008999e-03]
 ...
 [2.10184492e-02 3.45777660e-04 1.19496017e-01 ... 1.00000000e+00
  1.40199168e-02 3.74048133e-03]
 [2.15009318e-02 1.59282739e-03 3.38944104e-02 ... 1.40199168e-02
  1.00000000e+00 7.64898286e-03]
 [1.90508141e-03 4.84646659e-03 9.55008999e-03 ... 3.74048133e-03
  7.64898286e-03 1.00000000e+00]] 
Gram(X) mean : 0.08434050065710545
Gram(Y) : [[1.         0.99999306 0.99999306 ... 0.99999306 0.99999306 0.99999306]
 [0.99999306 1.         0.99999306 ... 0.99999306 0.99999306 0.99999306]
 [0.99999306 0.99999306 1.         ... 0.99999306 0.99999306 0.99999306]
 ...
 [0.99999306 0.99999306 0.99999306 ... 1.         0.99999306 0.99999306]
 [0.99999306 0.99999306 0.99999306 ... 0.99999306 1.         0.99999306]
 [0.99999306 0.99999306 0.99999306 ... 0.99999306 0.99999306 1.        ]] 
Gram(Y) mean : 0.999993801857859

-------------------------------------------------
HSIC(lay1, act5) = 1.7399524437394138e-07
m : 10000
sigma : 75
-------------------------------------------------

